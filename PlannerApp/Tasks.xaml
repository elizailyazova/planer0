<Window x:Class="PlannerApp.Tasks"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:PlannerApp.ViewModels"
        WindowStartupLocation="CenterScreen" WindowState="Maximized" 
        Title="Tasks" Height="768" Width="1366">

    <Window.Resources>
        <local:TakeFirstTwoConverter x:Key="TakeFirstTwoConverter"/>
        <local:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
        <local:InverseBoolToVisibilityConverter x:Key="InverseBoolToVisibilityConverter"/>
    </Window.Resources>

    <Grid>

        <!-- Верхнее меню -->
        <DockPanel Height="100" Background="#F8F8F8" VerticalAlignment="Top" Margin="0,0,0,10">
            <DockPanel.Effect>
                <DropShadowEffect Color="Gray" BlurRadius="10" ShadowDepth="3" Opacity="0.3"/>
            </DockPanel.Effect>
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Margin="90,30,0,0">
                <TextBlock Text="Task" Foreground="#41AB49" FontSize="32" FontWeight="SemiBold"/>
                <TextBlock Text="Track" Foreground="Black" FontSize="32" FontWeight="SemiBold" Margin="5,0,0,0" Width="82"/>
            </StackPanel>
            <Grid Width="695" Height="40" Margin="166,0" HorizontalAlignment="Center">
                <TextBox Width="695" Height="40" Background="#F5F8FF" Padding="10" VerticalContentAlignment="Center">
                    <TextBox.Style>
                        <Style TargetType="TextBox">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="TextBox">
                                        <Border Background="{TemplateBinding Background}"
                                        CornerRadius="8"
                                        BorderThickness="0"  
                                        Padding="{TemplateBinding Padding}">
                                            <ScrollViewer x:Name="PART_ContentHost"/>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </TextBox.Style>
                    <TextBox.Effect>
                        <DropShadowEffect Color="Gray" BlurRadius="8" ShadowDepth="2" Opacity="0.3"/>
                    </TextBox.Effect>
                </TextBox>
                <TextBlock Text="Search your task here..." VerticalAlignment="Center" HorizontalAlignment="Left" Padding="15,0,0,0" Foreground="Gray" IsHitTestVisible="False"
                   Visibility="{Binding Text.Length, ElementName=textBox}"/>

                <Button Width="40" Height="40" Background="#41AB49" Foreground="White" BorderThickness="0"
                HorizontalAlignment="Right" VerticalAlignment="Center">
                    <Button.Resources>
                        <Style TargetType="Border">
                            <Setter Property="CornerRadius" Value="8"/>
                        </Style>
                    </Button.Resources>
                    <Image Source="/images/search.png" Width="15" Height="15"/>
                </Button>

            </Grid>

            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,0,90,0">
                <Button Width="40" Height="40" Background="#41AB49" Foreground="White" BorderThickness="0"
                HorizontalAlignment="Right" VerticalAlignment="Center">
                    <Button.Resources>
                        <Style TargetType="Border">
                            <Setter Property="CornerRadius" Value="8"/>
                        </Style>
                    </Button.Resources>
                    <Image Source="images/notification.png" Width="15" Height="15"/>
                </Button>

                <StackPanel Orientation="Vertical" HorizontalAlignment="Right" Margin="10,30">
                    <TextBlock Text="{Binding CurrentDay}" Foreground="Black" FontSize="15" HorizontalAlignment="Center"/>
                    <TextBlock Text="{Binding CurrentDate}" Foreground="#3ABEFF" FontSize="14" HorizontalAlignment="Center"/>
                </StackPanel>

            </StackPanel>
        </DockPanel>

        <Grid Margin="0,105,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="305"/>
                <ColumnDefinition Width="970"/>
            </Grid.ColumnDefinitions>

            <!-- Боковое меню -->

            <Grid Height="550"  VerticalAlignment="Top" Margin="0,0,0,0">
                <Border Background="#408057" CornerRadius="8"
    BorderBrush="#A1A3AB" BorderThickness="1" Margin="0,0,0,0" Height="660" VerticalAlignment="Top">

                    <StackPanel Margin="10">
                        <Ellipse Width="70" Height="70"  Margin="0,10,0,10">
                            <Ellipse.Fill>
                                <ImageBrush x:Name="AvatarBrush" Stretch="UniformToFill"/>
                            </Ellipse.Fill>
                        </Ellipse>

                        <StackPanel VerticalAlignment="Bottom">
                            <TextBlock Name="UsernameText" Text="Asel" Foreground="White" FontSize="16" FontWeight="Bold" HorizontalAlignment="Center"/>
                            <TextBlock Name="EmailText" Text="asel@gmail.com" Foreground="White" FontSize="12" HorizontalAlignment="Center"/>
                        </StackPanel>



                        <Button Background="Transparent" Foreground="White" FontSize="16" Height="59" BorderThickness="0" HorizontalAlignment="Left" Margin="50,10,0,0">
                            <StackPanel Orientation="Horizontal">
                                <Image Source="/Images/dashboard.png" Width="15" Height="15" Margin="0,0,10,0"/>
                                <TextBlock Text="Dashboard" VerticalAlignment="Center" Width="118"/>
                            </StackPanel>
                        </Button>

                        <Button Background="Transparent" Foreground="White" FontSize="16" Height="59" BorderThickness="0" HorizontalAlignment="Left" Margin="50,0,0,0">
                            <StackPanel Orientation="Horizontal">
                                <Image Source="images/statitics.png" Width="15" Height="15" Margin="0,0,10,0"/>
                                <TextBlock Text="Statistics" VerticalAlignment="Center" Width="118"/>
                            </StackPanel>
                        </Button>

                        <Button Click="OpenAddTask" Background="Transparent" Foreground="White" FontSize="16" Height="59" BorderThickness="0" HorizontalAlignment="Left" Margin="50,0,0,0">
                            <StackPanel Orientation="Horizontal">
                                <Image Source="images/my task.png" Width="15" Height="15" Margin="0,0,10,0"/>
                                <TextBlock Text="My Task" VerticalAlignment="Center" Width="116"/>
                            </StackPanel>
                        </Button>

                        <Button Background="Transparent" Foreground="White" FontSize="16" Height="59" BorderThickness="0" HorizontalAlignment="Left" Margin="50,0,0,0"
                Click="OpenCategory">
                            <StackPanel Orientation="Horizontal">
                                <Image Source="images/mycategories.png" Width="15" Height="15" Margin="0,0,10,0"/>
                                <TextBlock Text="Task Categories" VerticalAlignment="Center" Width="113"/>
                            </StackPanel>
                        </Button>


                        <Button Background="Transparent" Foreground="White" FontSize="16" Height="59" BorderThickness="0" HorizontalAlignment="Left" Margin="50,0,0,0">
                            <StackPanel Orientation="Horizontal">
                                <Image Source="images/settings.png" Width="15" Height="15" Margin="0,0,10,0"/>
                                <TextBlock Text="My Profile" VerticalAlignment="Center" Width="116"/>
                            </StackPanel>
                        </Button>

                        <Button Click="Logout" Background="Transparent" Foreground="White" FontSize="16" Height="66" BorderThickness="0"  VerticalAlignment="Bottom" HorizontalAlignment="Left" Margin="50,0,0,0">
                            <StackPanel Orientation="Horizontal">
                                <Image Source="images/logout.png" Width="15" Height="15" Margin="0,0,10,0"/>
                                <TextBlock Text="Logout"/>
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </Border>
            </Grid>
            <!-- Основная область -->
            <ScrollViewer Grid.Column="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled" Margin="10,0,0,0">
                <Grid Grid.Column="1" VerticalAlignment="Top" Margin="20, 10, 20, 20">
                    <Border Background="#F5F8FF" CornerRadius="16" Padding="20" Margin="40,10,40,10"
                        BorderBrush="#A1A3AB" BorderThickness="1">
                        <Border.Effect>
                            <DropShadowEffect Color="Black" BlurRadius="10" ShadowDepth="5" Opacity="0.3"/>
                        </Border.Effect>

                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Grid Grid.Row="0" Margin="0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Button  Content="Go Back" Foreground="Black" FontSize="14" FontWeight="SemiBold"
        Background="{x:Null}" BorderThickness="0"
        HorizontalAlignment="Right" Margin="10" Cursor="Hand"/>



                            </Grid>
                            <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled" Margin="10,0,0,18" Grid.RowSpan="3">
                                <Border Grid.Row="1" Height="459" Background="Transparent" Padding="10" Margin="5"
                                BorderBrush="#A1A3AB" BorderThickness="0" Width="783">
                                    <StackPanel Margin="0,0,0,15">
                                        <StackPanel Orientation="Horizontal" Margin="0, 0, 0, 0">
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Stretch">

                                                <TextBlock Name="titleTextbox" 
                                                   FontSize="24" 
                                                   FontWeight="SemiBold" 
                                                   VerticalAlignment="Center"  
                                                   Foreground="Black"  
                                                   Margin="20, 0, 0, 0" 
                                                   Padding="5"
                                                   Text="{Binding Task.Title}"
                                                   Visibility="{Binding IsReadOnly, Converter={StaticResource TakeFirstTwoConverter}}"/>
                                                <TextBox Text="{Binding Task.Title, UpdateSourceTrigger=PropertyChanged}"
                                                 FontSize="24"
                                                 FontWeight="SemiBold"
                                                 VerticalAlignment="Center"
                                                 Foreground="Black"
                                                 Margin="20, 0, 0, 0"
                                                 Padding="5"
                                                 Height="50"
                                                 Width="346"
                                                 Visibility="{Binding IsReadOnly, Converter={StaticResource InverseBoolToVisibilityConverter}}">
                                                    <TextBox.Style>
                                                        <Style TargetType="TextBox">
                                                            <Setter Property="Template">
                                                                <Setter.Value>
                                                                    <ControlTemplate TargetType="TextBox">
                                                                        <Border Background="Transparent"
                                                                        CornerRadius="6"
                                                                        BorderThickness="1"
                                                                        BorderBrush="#A1A3AB"
                                                                        Padding="{TemplateBinding Padding}">
                                                                            <ScrollViewer x:Name="PART_ContentHost"/>
                                                                        </Border>
                                                                    </ControlTemplate>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </Style>
                                                    </TextBox.Style>
                                                </TextBox>
                                            </StackPanel>
                                        </StackPanel>

                                        <StackPanel Orientation="Horizontal" Margin="0, 10, 0, 0">
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Stretch">
                                                <TextBlock Text="Date:" 
                                                   FontSize="14" 
                                                   VerticalAlignment="Center" 
                                                   FontWeight="Regular" 
                                                   Margin="40, 0, 0, 0"/>
                                                <TextBlock Name="DateTextBlock" 
                                                   FontSize="14" 
                                                   VerticalAlignment="Center" 
                                                   Foreground="#41AB49" 
                                                   Margin="5, 0, 0, 0" 
                                                   Padding="5"
                                                   Text="{Binding Task.Date, StringFormat='dd.MM.yyyy'}"
                                                   Visibility="{Binding IsReadOnly, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                                <DatePicker SelectedDate="{Binding Task.Date}"
                                                    FontSize="14"
                                                    Foreground="#41AB49"
                                                    VerticalAlignment="Center"
                                                    Margin="5, 0, 0, 0"
                                                    Padding="5"
                                                    Width="120"
                                                    Visibility="{Binding IsReadOnly, Converter={StaticResource InverseBoolToVisibilityConverter}}">
                                                    <DatePicker.Style>
                                                        <Style TargetType="DatePicker">
                                                            <Setter Property="Template">
                                                                <Setter.Value>
                                                                    <ControlTemplate TargetType="DatePicker">
                                                                        <Border Background="Transparent"
                                                                        CornerRadius="6"
                                                                        BorderThickness="1"
                                                                        BorderBrush="#A1A3AB"
                                                                        Padding="{TemplateBinding Padding}">
                                                                            <Grid>
                                                                                <DatePickerTextBox x:Name="PART_TextBox"/>
                                                                                <Button x:Name="PART_Button"
                                                                            Content="📅"
                                                                            Background="White"
                                                                            BorderThickness="0"
                                                                            HorizontalAlignment="Right"
                                                                            ClickMode="Press"/>
                                                                            </Grid>
                                                                        </Border>
                                                                    </ControlTemplate>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </Style>
                                                    </DatePicker.Style>
                                                </DatePicker>
                                            </StackPanel>
                                        </StackPanel>

                                        <StackPanel Orientation="Horizontal" Margin="0, 10, 0, 0">
                                            <StackPanel Orientation="Horizontal" Width="235">
                                                <TextBlock Text="Time:" 
                                                   VerticalAlignment="Center" 
                                                   FontSize="14" 
                                                   FontWeight="Regular" 
                                                   Margin="40, 0, 0, 0"/>
                                                <TextBlock Name="timeTextbox" 
                                                   VerticalAlignment="Center" 
                                                   FontSize="14" 
                                                   Foreground="#41AB49"  
                                                   Margin="5, 0, 0, 0" 
                                                   Padding="5"
                                                   Text="{Binding Task.Time, StringFormat='hh\\:mm'}"
                                                   Visibility="{Binding IsReadOnly, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                                <TextBox Text="{Binding Task.Time, StringFormat='hh\\:mm', UpdateSourceTrigger=PropertyChanged}"
                                                 FontSize="14"
                                                 Foreground="Black"
                                                 Height="40"
                                                 VerticalAlignment="Center"
                                                 Margin="5, 0, 0, 0"
                                                 Padding="5"
                                                 Width="127"
                                                 Visibility="{Binding IsReadOnly, Converter={StaticResource InverseBoolToVisibilityConverter}}">
                                                    <TextBox.Style>
                                                        <Style TargetType="TextBox">
                                                            <Setter Property="Template">
                                                                <Setter.Value>
                                                                    <ControlTemplate TargetType="TextBox">
                                                                        <Border Background="Transparent"
                                                                        CornerRadius="6"
                                                                        BorderThickness="1"
                                                                        BorderBrush="#A1A3AB"
                                                                        Padding="{TemplateBinding Padding}">
                                                                            <ScrollViewer x:Name="PART_ContentHost"/>
                                                                        </Border>
                                                                    </ControlTemplate>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </Style>
                                                    </TextBox.Style>
                                                </TextBox>
                                            </StackPanel>
                                        </StackPanel>

                                        <StackPanel Orientation="Horizontal" Margin="34, 10, 0, 0">
                                            <TextBlock Text="Category:" 
                                               VerticalAlignment="Center" 
                                               FontSize="14" 
                                               FontWeight="Regular" 
                                               Margin="5, 0, 10, 0"/>
                                            <TextBlock Name="CategoryTextBlock" 
                                               VerticalAlignment="Center" 
                                               FontSize="14" 
                                               Foreground="#41AB49" 
                                               Margin="0, 0, 0, 0" 
                                               Padding="5"
                                               Text="{Binding Task.Category}"
                                               Visibility="{Binding IsReadOnly, Converter={StaticResource BoolToVisibilityConverter}}"/>

                                            <ComboBox Name="CategoryComboBox"
                                              Width="150"
                                              Height="35"
                                              Margin="0, 10, 330, 0"
                                              Padding="10"
                                              ItemsSource="{Binding Categories}"
                                              SelectedItem="{Binding Task.Category, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                              VerticalAlignment="Center"
                                              Visibility="{Binding IsReadOnly, Converter={StaticResource InverseBoolToVisibilityConverter}}">
                                            </ComboBox>
                                        </StackPanel>

                                        <StackPanel Orientation="Horizontal" Margin="40, 10, 0, 0">
                                            <StackPanel Orientation="Horizontal" Width="235">
                                                <TextBlock Text="Status:" 
                                                   FontSize="14" 
                                                   VerticalAlignment="Center" 
                                                   FontWeight="Regular"/>
                                                <TextBlock Text="{Binding Task.Status}"
                                                   FontSize="14"
                                                   Foreground="#41AB49"
                                                   VerticalAlignment="Center"
                                                   Margin="5, 0, 0, 0"
                                                   Padding="5"
                                                   Visibility="{Binding IsReadOnly, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                                <ComboBox Name="StatusComboBox"
                                                  Width="150"
                                                  Height="35"
                                                  Margin="5, 10, 330, 0"
                                                  Padding="10"
                                                  ItemsSource="{Binding StatusOptions}"
                                                  SelectedItem="{Binding Task.Status, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                  VerticalAlignment="Center"
                                                  Visibility="{Binding IsReadOnly, Converter={StaticResource InverseBoolToVisibilityConverter}}">
                                                </ComboBox>
                                            </StackPanel>
                                        </StackPanel>

                                        <TextBlock Text="Description" 
                                           FontSize="15" 
                                           FontWeight="SemiBold" 
                                           Margin="40, 20, 0, 0"/>
                                        <Border Width="398" 
                                        Height="110" 
                                        Background="#F5F5F5" 
                                        Margin="35, 10, 330, 0" 
                                        Padding="5"
                                        CornerRadius="6"
                                        BorderThickness="1"  
                                        BorderBrush="#A1A3AB"
                                        Visibility="{Binding IsReadOnly, Converter={StaticResource BoolToVisibilityConverter}}">
                                            <ScrollViewer VerticalScrollBarVisibility="Auto" Margin="0,0,56,-6">
                                                <TextBlock Text="{Binding Task.Description}" 
                                                   TextWrapping="Wrap" HorizontalAlignment="Left"/>
                                            </ScrollViewer>
                                        </Border>
                                    </StackPanel>
                                </Border>
                            </ScrollViewer>


                            <Button x:Name="EditButton" Grid.Row="2" Content="Edit" Background="#408057" Foreground="White" 
                                BorderThickness="0" Width="80" Height="35" HorizontalAlignment="Left" Margin="20,0,0,0"
                                Command="{Binding EditCommand}" Visibility="{Binding EditButtonVisibility}">
                                <Button.Resources>
                                    <Style TargetType="Border">
                                        <Setter Property="CornerRadius" Value="6"/>
                                    </Style>
                                </Button.Resources>
                            </Button>

                            <Button x:Name="UpdateButton" Grid.Row="2" Content="Save" Background="#408057" Foreground="White" 
                                BorderThickness="0" Width="80" Height="35" HorizontalAlignment="Left" Margin="20,0,0,0"
                                Command="{Binding UpdateCommand}" Visibility="{Binding UpdateButtonVisibility}">
                                <Button.Resources>
                                    <Style TargetType="Border">
                                        <Setter Property="CornerRadius" Value="6"/>
                                    </Style>
                                </Button.Resources>
                            </Button>

                            <Button x:Name="CancelButton" Grid.Row="2" Content="Cancel" Background="White" Foreground="#408057" 
                                BorderBrush="#408057" BorderThickness="1" Width="100" Height="35" 
                                HorizontalAlignment="Left" Margin="120,0,0,0" Command="{Binding CancelCommand}">
                                <Button.Resources>
                                    <Style TargetType="Border">
                                        <Setter Property="CornerRadius" Value="6"/>
                                    </Style>
                                </Button.Resources>
                            </Button>

                            <Button x:Name="DeleteButton" Grid.Row="2" Content="Delete" Background="#408057" Foreground="White" 
                                BorderThickness="0" Width="100" Height="35" HorizontalAlignment="Right" Margin="0,0,20,0"
                                Command="{Binding DeleteCommand}">
                                <Button.Resources>
                                    <Style TargetType="Border">
                                        <Setter Property="CornerRadius" Value="6"/>
                                    </Style>
                                </Button.Resources>
                            </Button>
                        </Grid>
                    </Border>

                </Grid>
            </ScrollViewer>
        </Grid>

    </Grid>

</Window>
